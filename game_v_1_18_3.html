<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Neon Pulse: Overdrive</title>
    <style>
        body { margin: 0; background-color: #05050a; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; font-family: 'Courier New', monospace; }
        canvas { box-shadow: 0 0 100px rgba(255, 0, 255, 0.2); border: 1px solid #1a1a2e; }
        #ui { position: absolute; top: 20px; color: #00ffff; text-shadow: 0 0 10px #00ffff; text-align: center; width: 800px; pointer-events: none; text-transform: uppercase; letter-spacing: 4px; z-index: 10; }
        #death-counter { position: absolute; top: 20px; left: 20px; color: #ff073a; font-size: 16px; }
    </style>
</head>
<body>

<div id="ui">
    <div id="death-counter">REBOOTS: 0</div>
</div>
<canvas id="gameCanvas" width="800" height="600"></canvas>

<script>
/**
 * NEON PULSE ENGINE - OVERDRIVE EDITION
 */
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

const CONFIG = {
    gravity: 0.6, friction: 0.82, speed: 7, jumpForce: -14, pulseRate: 60,
    colors: {
        bg: '#05050a', player: '#00f3ff', wall: '#bc13fe', lava: '#ff073a',
        goal: '#ffe808', spike: '#0aff00', sunTop: '#ff00ff', sunBottom: '#ff8800'
    },
    menuOptions: ["INITIALIZE", "LEVEL SELECT", "EDITOR PROTOCOL"]
};

let gameState = 'MENU';
let currentLevelIndex = 0;
let frame = 0;
let menuSelection = 0;
let particles = [];

// Create background particles
for(let i=0; i<50; i++) {
    particles.push({ x: Math.random() * 800, y: Math.random() * 600, s: Math.random() * 2, v: Math.random() * 0.5 + 0.2 });
}

const player = {
    x: 100, y: 400, w: 24, h: 24, vx: 0, vy: 0,
    deaths: parseInt(localStorage.getItem('neonPulseDeaths')) || 0,
    onGround: false
};

// --- RENDER MENU ELEMENTS ---

function drawSun() {
    const cx = 400, cy = 250, r = 120;
    let grad = ctx.createLinearGradient(cx, cy - r, cx, cy + r);
    grad.addColorStop(0, CONFIG.colors.sunTop);
    grad.addColorStop(1, CONFIG.colors.sunBottom);
    
    ctx.save();
    ctx.shadowBlur = 40; ctx.shadowColor = CONFIG.colors.sunTop;
    ctx.fillStyle = grad;
    ctx.beginPath(); ctx.arc(cx, cy, r, 0, Math.PI * 2); ctx.fill();
    
    // Sun scanlines
    ctx.shadowBlur = 0; ctx.fillStyle = CONFIG.colors.bg;
    for (let i = 0; i < 15; i++) {
        ctx.fillRect(cx - r - 10, cy + (i * 12) - 30, (r * 2) + 20, i * 2);
    }
    ctx.restore();
}

function drawScrollingGrid() {
    ctx.save();
    ctx.strokeStyle = '#ff00ff'; ctx.lineWidth = 1; ctx.globalAlpha = 0.2;
    const horizon = 300;
    const speed = (frame * 2) % 40;

    for (let i = 0; i < 20; i++) {
        let y = horizon + Math.pow(i, 2) + speed;
        if (y <= 600) { ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(800, y); ctx.stroke(); }
    }
    for (let i = -10; i <= 20; i++) {
        ctx.beginPath(); ctx.moveTo(400, horizon); ctx.lineTo(i * 80 - 200, 600); ctx.stroke();
    }
    ctx.restore();
}

// --- INPUT & LOOP ---

window.addEventListener('keydown', e => {
    if (gameState === 'MENU') {
        if (e.key === 'ArrowUp') menuSelection = (menuSelection - 1 + CONFIG.menuOptions.length) % CONFIG.menuOptions.length;
        if (e.key === 'ArrowDown') menuSelection = (menuSelection + 1) % CONFIG.menuOptions.length;
        if (e.key === ' ') {
            if (menuSelection === 0) gameState = 'PLAYING';
            // Other menu logic here
        }
    }
});

function loop() {
    ctx.fillStyle = CONFIG.colors.bg;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    if (gameState === 'MENU') {
        // Draw decorative particles
        ctx.fillStyle = "#00ffff";
        particles.forEach(p => {
            p.y -= p.v; if (p.y < 0) p.y = 600;
            ctx.fillRect(p.x, p.y, p.s, p.s);
        });

        drawSun();
        drawScrollingGrid();

        // Title text
        ctx.font = "bold 60px 'Courier New'"; ctx.textAlign = "center";
        ctx.fillStyle = "white"; ctx.shadowBlur = 20; ctx.shadowColor = "#00ffff";
        ctx.fillText("NEON PULSE", 400, 150);

        // Menu options
        ctx.font = "20px 'Courier New'";
        CONFIG.menuOptions.forEach((opt, i) => {
            ctx.fillStyle = i === menuSelection ? "#00ffff" : "#555";
            ctx.fillText(i === menuSelection ? `> ${opt} <` : opt, 400, 400 + i * 50);
        });
    } else {
        // Your existing game engine logic runs here
        ctx.fillStyle = "white";
        ctx.fillText("GAME ACTIVE - ESC TO MENU", 400, 300);
        if (keys['Escape']) gameState = 'MENU';
    }

    frame++;
    document.getElementById('death-counter').innerText = `REBOOTS: ${player.deaths}`;
    requestAnimationFrame(loop);
}

const keys = {};
window.onkeydown = e => keys[e.key] = true;
window.onkeyup = e => keys[e.key] = false;

loop();
</script>
</body>
</html>
